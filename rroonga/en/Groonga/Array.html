<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../ranguba.css" type="text/css" />
    <link rel="shortcut icon" href="../../../favicon.ico" />
    <link rel="icon" href="../../../favicon.png" />
    <title>
  Class: Groonga::Array
  
    &mdash; rroonga
  
 - Ranguba</title>


  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
<div class="header">
  <div class="title">
    <a href="../../../">
      <span class="title">
  Class: Groonga::Array
  
    &mdash; rroonga
  
</span>
      <span class="title-separator">-</span>
      <span class="title-project">Ranguba</span>
    </a>
  </div>
  <ul class="other-languages">
    <li id="other-language-japanese" lang="ja" xml:lang="ja"><a href="../../../rroonga/ja/Groonga/Array.html">日本語</a></li>
  </ul>
  <ul class="menu">
    <li id="menu-reference"><a href="../../../rroonga/en/">Reference Manual</a></li>
    <li id="menu-tutorial"><a href="../../../rroonga/en/file.tutorial.html">Tutorial</a></li>
    <li id="menu-install"><a href="../../../#install-rroonga">Install</a></li>
    <li id="menu-developer"><a href="../../../developer.html">Developer</a></li>
  </ul>
</div>

<div class="content">


    <div id="header">
      <div id="menu">
  
    <a href="../alphabetical_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Groonga.html" title="Groonga (module)">Groonga</a></span></span>
     &raquo; 
    <span class="title">Array</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Groonga::Array
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Table.html" title="Groonga::Table (class)">Table</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></li>
          
            <li class="next"><span class='object_link'><a href="Table.html" title="Groonga::Table (class)">Table</a></span></li>
          
            <li class="next">Groonga::Array</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">ext/groonga/rb-grn-array.c<span class="defines">,<br />
  ext/groonga/rb-grn-array.c</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>各レコードがキーに関連付けられていないテーブル。レコードは
IDで識別する。</p>

  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-class_method" title="create (class method)">+ (Object) <strong>create</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>キーのないテーブルを生成する。ブロックを指定すると、そのブ ロックに生成したテーブルが渡され、ブロックを抜けると自動的 にテーブルが破棄される。.</p></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add-instance_method" title="#add (instance method)">- (Groonga::Recordまたはnil) <strong>add</strong>(values = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>レコード追加し、追加したレコードを返す。レコードの追加に失 敗した場合は <ins>nil</ins> を返す。.</p></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pull-instance_method" title="#pull (instance method)">- (Groonga::Record or nil) <strong>pull</strong>(options = {}) {|record| ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Pulls a record from the array.</p></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#push-instance_method" title="#push (instance method)">- (Groonga::Record or nil) <strong>push</strong> {|record| ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Pushes a record to the array.</p></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unblock-instance_method" title="#unblock (instance method)">- (void) <strong>unblock</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Unblocks all <span class='object_link'><a href="#pull-instance_method" title="Groonga::Array#pull (method)">#pull</a></span> operations for the array.</p></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="Table.html" title="Groonga::Table (class)">Table</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Table.html#%5B%5D-instance_method" title="Groonga::Table#[] (method)">#[]</a></span>, <span class='object_link'><a href="Table.html#clear_lock-instance_method" title="Groonga::Table#clear_lock (method)">#clear_lock</a></span>, <span class='object_link'><a href="Table.html#column-instance_method" title="Groonga::Table#column (method)">#column</a></span>, <span class='object_link'><a href="Table.html#column_value-instance_method" title="Groonga::Table#column_value (method)">#column_value</a></span>, <span class='object_link'><a href="Table.html#columns-instance_method" title="Groonga::Table#columns (method)">#columns</a></span>, <span class='object_link'><a href="Table.html#define_column-instance_method" title="Groonga::Table#define_column (method)">#define_column</a></span>, <span class='object_link'><a href="Table.html#define_index_column-instance_method" title="Groonga::Table#define_index_column (method)">#define_index_column</a></span>, <span class='object_link'><a href="Table.html#defrag-instance_method" title="Groonga::Table#defrag (method)">#defrag</a></span>, <span class='object_link'><a href="Table.html#delete-instance_method" title="Groonga::Table#delete (method)">#delete</a></span>, <span class='object_link'><a href="Table.html#difference%21-instance_method" title="Groonga::Table#difference! (method)">#difference!</a></span>, <span class='object_link'><a href="Table.html#each-instance_method" title="Groonga::Table#each (method)">#each</a></span>, <span class='object_link'><a href="Table.html#each_sub_record-instance_method" title="Groonga::Table#each_sub_record (method)">#each_sub_record</a></span>, <span class='object_link'><a href="Table.html#empty%3F-instance_method" title="Groonga::Table#empty? (method)">#empty?</a></span>, <span class='object_link'><a href="Table.html#exist%3F-instance_method" title="Groonga::Table#exist? (method)">#exist?</a></span>, <span class='object_link'><a href="Table.html#group-instance_method" title="Groonga::Table#group (method)">#group</a></span>, <span class='object_link'><a href="Table.html#have_column%3F-instance_method" title="Groonga::Table#have_column? (method)">#have_column?</a></span>, <span class='object_link'><a href="Table.html#have_n_sub_records_space%3F-instance_method" title="Groonga::Table#have_n_sub_records_space? (method)">#have_n_sub_records_space?</a></span>, <span class='object_link'><a href="Table.html#initialize-instance_method" title="Groonga::Table#initialize (method)">#initialize</a></span>, <span class='object_link'><a href="Table.html#inspect-instance_method" title="Groonga::Table#inspect (method)">#inspect</a></span>, <span class='object_link'><a href="Table.html#intersection%21-instance_method" title="Groonga::Table#intersection! (method)">#intersection!</a></span>, <span class='object_link'><a href="Table.html#lock-instance_method" title="Groonga::Table#lock (method)">#lock</a></span>, <span class='object_link'><a href="Table.html#locked%3F-instance_method" title="Groonga::Table#locked? (method)">#locked?</a></span>, <span class='object_link'><a href="Table.html#merge%21-instance_method" title="Groonga::Table#merge! (method)">#merge!</a></span>, <span class='object_link'><a href="Table.html#open_cursor-instance_method" title="Groonga::Table#open_cursor (method)">#open_cursor</a></span>, <span class='object_link'><a href="Table.html#paginate-instance_method" title="Groonga::Table#paginate (method)">#paginate</a></span>, <span class='object_link'><a href="Table.html#records-instance_method" title="Groonga::Table#records (method)">#records</a></span>, <span class='object_link'><a href="Table.html#rename-instance_method" title="Groonga::Table#rename (method)">#rename</a></span>, <span class='object_link'><a href="Table.html#select-instance_method" title="Groonga::Table#select (method)">#select</a></span>, <span class='object_link'><a href="Table.html#set_column_value-instance_method" title="Groonga::Table#set_column_value (method)">#set_column_value</a></span>, <span class='object_link'><a href="Table.html#set_value-instance_method" title="Groonga::Table#set_value (method)">#set_value</a></span>, <span class='object_link'><a href="Table.html#size-instance_method" title="Groonga::Table#size (method)">#size</a></span>, <span class='object_link'><a href="Table.html#sort-instance_method" title="Groonga::Table#sort (method)">#sort</a></span>, <span class='object_link'><a href="Table.html#support_key%3F-instance_method" title="Groonga::Table#support_key? (method)">#support_key?</a></span>, <span class='object_link'><a href="Table.html#support_sub_records%3F-instance_method" title="Groonga::Table#support_sub_records? (method)">#support_sub_records?</a></span>, <span class='object_link'><a href="Table.html#truncate-instance_method" title="Groonga::Table#truncate (method)">#truncate</a></span>, <span class='object_link'><a href="Table.html#union%21-instance_method" title="Groonga::Table#union! (method)">#union!</a></span>, <span class='object_link'><a href="Table.html#unlock-instance_method" title="Groonga::Table#unlock (method)">#unlock</a></span>, <span class='object_link'><a href="Table.html#value-instance_method" title="Groonga::Table#value (method)">#value</a></span></p>

  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Object.html#%3D%3D-instance_method" title="Groonga::Object#== (method)">#==</a></span>, <span class='object_link'><a href="Object.html#%5B%5D-instance_method" title="Groonga::Object#[] (method)">#[]</a></span>, <span class='object_link'><a href="Object.html#%5B%5D%3D-instance_method" title="Groonga::Object#[]= (method)">#[]=</a></span>, <span class='object_link'><a href="Object.html#append-instance_method" title="Groonga::Object#append (method)">#append</a></span>, <span class='object_link'><a href="Object.html#builtin%3F-instance_method" title="Groonga::Object#builtin? (method)">#builtin?</a></span>, <span class='object_link'><a href="Object.html#close-instance_method" title="Groonga::Object#close (method)">#close</a></span>, <span class='object_link'><a href="Object.html#closed%3F-instance_method" title="Groonga::Object#closed? (method)">#closed?</a></span>, <span class='object_link'><a href="Object.html#domain-instance_method" title="Groonga::Object#domain (method)">#domain</a></span>, <span class='object_link'><a href="Object.html#id-instance_method" title="Groonga::Object#id (method)">#id</a></span>, <span class='object_link'><a href="Object.html#inspect-instance_method" title="Groonga::Object#inspect (method)">#inspect</a></span>, <span class='object_link'><a href="Object.html#name-instance_method" title="Groonga::Object#name (method)">#name</a></span>, <span class='object_link'><a href="Object.html#path-instance_method" title="Groonga::Object#path (method)">#path</a></span>, <span class='object_link'><a href="Object.html#persistent%3F-instance_method" title="Groonga::Object#persistent? (method)">#persistent?</a></span>, <span class='object_link'><a href="Object.html#prepend-instance_method" title="Groonga::Object#prepend (method)">#prepend</a></span>, <span class='object_link'><a href="Object.html#range-instance_method" title="Groonga::Object#range (method)">#range</a></span>, <span class='object_link'><a href="Object.html#remove-instance_method" title="Groonga::Object#remove (method)">#remove</a></span>, <span class='object_link'><a href="Object.html#temporary%3F-instance_method" title="Groonga::Object#temporary? (method)">#temporary?</a></span>, <span class='object_link'><a href="Object.html#unlink-instance_method" title="Groonga::Object#unlink (method)">#unlink</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <p class="notice">This class inherits a constructor from <span class='object_link'><a href="Table.html#initialize-instance_method" title="Groonga::Table#initialize (method)">Groonga::Table</a></span></p>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="create-class_method">
  
    
      <span class="overload">+ (<tt><span class='object_link'><a href="" title="Groonga::Array (class)">Groonga::Array</a></span></tt>) <strong>create</strong>(options = {}) </span>
    
      <span class="overload">+ (<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>) <strong>create</strong>(options = {}) {|table| ... }</span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>キーのないテーブルを生成する。ブロックを指定すると、そのブ
ロックに生成したテーブルが渡され、ブロックを抜けると自動的
にテーブルが破棄される。</p>

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='comment'>#無名一時テーブルを生成する。
</span><span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span>

<span class='comment'>#無名永続テーブルを生成する。
</span><span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='symbol'>:path</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/array.grn</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

<span class='comment'>#名前付き永続テーブルを生成する。ただし、ファイル名は気にしない。
</span><span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bookmarks</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                      <span class='symbol'>:persistent</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span>

<span class='comment'>#それぞれのレコードに512バイトの値を格納できる無名一時テーブルを生成する。
</span><span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='int'>512</span><span class='rparen'>)</span></code></pre>
    
  </div>

  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">+ (<tt><span class='object_link'><a href="" title="Groonga::Array (class)">Groonga::Array</a></span></tt>) <strong>create</strong>(options = {}) </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>::Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The name and value
pairs. Omitted names are initialized as the default value.</p></div>
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:context</span>
          <span class="type">(<tt><span class='object_link'><a href="Context.html" title="Groonga::Context (class)">Groonga::Context</a></span></tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>Groonga::Context.default</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>テーブルが利用する <span class='object_link'><a href="Context.html" title="Groonga::Context (class)">Context</a></span> 。</p></div>
          
        </li>
      
        <li>
          <span class="name">:name</span>
          <span class="type">(<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>The name
テーブルの名前。名前をつけると、 <span class='object_link'><a href="Context.html#%5B%5D-instance_method" title="Groonga::Context#[] (method)">Context#[]</a></span> に名
前を指定してテーブルを取得することができる。省略すると
無名テーブルになり、テーブルIDでのみ取得できる。</p></div>
          
        </li>
      
        <li>
          <span class="name">:path</span>
          <span class="type">(<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>テーブルを保存するパス。パスを指定すると永続テーブルとな
り、プロセス終了後もレコードは保持される。次回起動時に
<span class='object_link'><a href="Context.html#%5B%5D-instance_method" title="Groonga::Context#[] (method)">Context#[]</a></span> で保存されたレコードを利用することが
できる。省略すると一時テーブルになり、プロセスが終了する
とレコードは破棄される。</p></div>
          
        </li>
      
        <li>
          <span class="name">:persistent</span>
          <span class="type">(<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p><ins>true</ins> を指定すると永続テーブルとなる。 <ins>path</ins> を省略した
場合は自動的にパスが付加される。 <ins>:context</ins> で指定した
<span class='object_link'><a href="Context.html" title="Groonga::Context (class)">Context</a></span> に結びついているデータベースが一時デー
タベースの場合は例外が発生する。</p></div>
          
        </li>
      
        <li>
          <span class="name">:value_type</span>
          <span class="type">(<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>nil</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>値の型を指定する。省略すると値のための領域を確保しない。
値を保存したい場合は必ず指定すること。
参考: Type.new</p></div>
          
        </li>
      
        <li>
          <span class="name">:sub_records</span>
          <span class="type">(<tt><span class='object_link'><a href="Record.html" title="Groonga::Record (class)">Groonga::Record</a></span>#n_sub_records</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p><ins>true</ins> を指定すると <span class='object_link'><a href="Table.html#group-instance_method" title="Groonga::Table#group (method)">Table#group</a></span> でグループ化したときに、
<span class='object_link'><a href="Record.html#n_sub_records-instance_method" title="Groonga::Record#n_sub_records (method)">Record#n_sub_records</a></span> でグループに含まれるレコー
ドの件数を取得できる。</p></div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Groonga::Array (class)">Groonga::Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">+ (<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>) <strong>create</strong>(options = {}) {|table| ... }</span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>::Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The name and value
pairs. Omitted names are initialized as the default value.</p></div>
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:context</span>
          <span class="type">(<tt><span class='object_link'><a href="Context.html" title="Groonga::Context (class)">Groonga::Context</a></span></tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>Groonga::Context.default</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>テーブルが利用する <span class='object_link'><a href="Context.html" title="Groonga::Context (class)">Context</a></span> 。</p></div>
          
        </li>
      
        <li>
          <span class="name">:name</span>
          <span class="type">(<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>The name
テーブルの名前。名前をつけると、 <span class='object_link'><a href="Context.html#%5B%5D-instance_method" title="Groonga::Context#[] (method)">Context#[]</a></span> に名
前を指定してテーブルを取得することができる。省略すると
無名テーブルになり、テーブルIDでのみ取得できる。</p></div>
          
        </li>
      
        <li>
          <span class="name">:path</span>
          <span class="type">(<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>テーブルを保存するパス。パスを指定すると永続テーブルとな
り、プロセス終了後もレコードは保持される。次回起動時に
<span class='object_link'><a href="Context.html#%5B%5D-instance_method" title="Groonga::Context#[] (method)">Context#[]</a></span> で保存されたレコードを利用することが
できる。省略すると一時テーブルになり、プロセスが終了する
とレコードは破棄される。</p></div>
          
        </li>
      
        <li>
          <span class="name">:persistent</span>
          <span class="type">(<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p><ins>true</ins> を指定すると永続テーブルとなる。 <ins>path</ins> を省略した
場合は自動的にパスが付加される。 <ins>:context</ins> で指定した
<span class='object_link'><a href="Context.html" title="Groonga::Context (class)">Context</a></span> に結びついているデータベースが一時デー
タベースの場合は例外が発生する。</p></div>
          
        </li>
      
        <li>
          <span class="name">:value_type</span>
          <span class="type">(<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>nil</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>値の型を指定する。省略すると値のための領域を確保しない。
値を保存したい場合は必ず指定すること。
参考: Type.new</p></div>
          
        </li>
      
        <li>
          <span class="name">:sub_records</span>
          <span class="type">(<tt><span class='object_link'><a href="Record.html" title="Groonga::Record (class)">Groonga::Record</a></span>#n_sub_records</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p><ins>true</ins> を指定すると <span class='object_link'><a href="Table.html#group-instance_method" title="Groonga::Table#group (method)">Table#group</a></span> でグループ化したときに、
<span class='object_link'><a href="Record.html#n_sub_records-instance_method" title="Groonga::Record#n_sub_records (method)">Record#n_sub_records</a></span> でグループに含まれるレコー
ドの件数を取得できる。</p></div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>生成されたテーブル。ブロックを抜けると破棄される。</p></div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/groonga/rb-grn-array.c', line 86</span>

static VALUE
rb_grn_array_s_create (int argc, VALUE *argv, VALUE klass)
{
    grn_ctx *context = NULL;
    grn_obj *value_type = NULL, *table;
    const char *name = NULL, *path = NULL;
    unsigned name_size = 0;
    grn_obj_flags flags = GRN_OBJ_TABLE_NO_KEY;
    VALUE rb_table;
    VALUE options, rb_context, rb_name, rb_path, rb_persistent;
    VALUE rb_value_type, rb_sub_records;

    rb_scan_args(argc, argv, &quot;01&quot;, &amp;options);

    rb_grn_scan_options(options,
                        &quot;context&quot;, &amp;rb_context,
                        &quot;name&quot;, &amp;rb_name,
                        &quot;path&quot;, &amp;rb_path,
                        &quot;persistent&quot;, &amp;rb_persistent,
                        &quot;value_type&quot;, &amp;rb_value_type,
                        &quot;sub_records&quot;, &amp;rb_sub_records,
                        NULL);

    context = rb_grn_context_ensure(&amp;rb_context);

    if (!NIL_P(rb_name)) {
        name = StringValuePtr(rb_name);
        name_size = RSTRING_LEN(rb_name);
        flags |= GRN_OBJ_PERSISTENT;
    }

    if (!NIL_P(rb_path)) {
        path = StringValueCStr(rb_path);
        flags |= GRN_OBJ_PERSISTENT;
    }

    if (RVAL2CBOOL(rb_persistent))
        flags |= GRN_OBJ_PERSISTENT;

    if (!NIL_P(rb_value_type))
        value_type = RVAL2GRNOBJECT(rb_value_type, &amp;context);

    if (RVAL2CBOOL(rb_sub_records))
        flags |= GRN_OBJ_WITH_SUBREC;

    table = grn_table_create(context, name, name_size, path,
                             flags, NULL, value_type);
    if (!table)
        rb_grn_context_check(context, rb_ary_new4(argc, argv));
    rb_table = GRNOBJECT2RVAL(klass, context, table, GRN_TRUE);
    rb_grn_context_check(context, rb_table);
    rb_iv_set(rb_table, &quot;@context&quot;, rb_context);

    if (rb_block_given_p())
        return rb_ensure(rb_yield, rb_table, rb_grn_object_close, rb_table);
    else
        return rb_table;
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add-instance_method">
  
    - (<tt><span class='object_link'><a href="Record.html" title="Groonga::Record (class)">Groonga::Record</a></span>またはnil</tt>) <strong>add</strong>(values = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>レコード追加し、追加したレコードを返す。レコードの追加に失
敗した場合は <ins>nil</ins> を返す。</p>
<p><em>values</em> にはレコードのカラムに設定する値を指定する。省略
した場合または <ins>nil</ins> を指定した場合はカラムは設定しない。カ
ラムの値は <code>{:カラム名1 =&gt; 値1, :カラム名2 =&gt; 値2,
...}</code> と指定する。</p>

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='comment'>#以下のようなユーザを格納するGroonga::Arrayが
</span><span class='comment'>#定義されているものとする。
</span><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Users</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_define_column'>define_column</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ShortText</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_define_column'>define_column</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>uri</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ShortText</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'>#ユーザを追加する。
</span><span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span>

<span class='comment'>#daijiroユーザを追加する。
</span><span class='id identifier rubyid_daijiro'>daijiro</span> <span class='op'>=</span> <span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>daijiro</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

<span class='comment'>#gunyara-kunユーザを追加する。
</span><span class='id identifier rubyid_gunyara_kun'>gunyara_kun</span> <span class='op'>=</span> <span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gunyara-kun</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                        <span class='symbol'>:uri</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://d.hatena.ne.jp/tasukuchan/</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>

  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Record.html" title="Groonga::Record (class)">Groonga::Record</a></span>またはnil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/groonga/rb-grn-array.c', line 173</span>

static VALUE
rb_grn_array_add (int argc, VALUE *argv, VALUE self)
{
    grn_ctx *context = NULL;
    grn_obj *table;
    grn_id id;
    VALUE values;

    rb_scan_args(argc, argv, &quot;01&quot;, &amp;values);

    table = SELF(self, &amp;context);

    id = grn_table_add(context, table, NULL, 0, NULL);
    rb_grn_context_check(context, self);

    if (GRN_ID_NIL == id) {
        return Qnil;
    } else {
        return rb_grn_record_new_added(self, id, values);
    }
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="pull-instance_method">
  
    - (<tt><span class='object_link'><a href="Record.html" title="Groonga::Record (class)">Groonga::Record</a></span> or nil</tt>) <strong>pull</strong>(options = {}) {|record| ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Pulls a record from the array. The required values should be
retrieved in the given block.</p>
<p>If <span class='object_link'><a href="#push-instance_method" title="Groonga::Array#push (method)">#push</a></span> failes to fill values of the pushed
record, the pulled record may be uncompleted. It should be handled
by your application.</p>
<p>If you passes <code>:block? =&gt; true</code> option, the pull operation blocks
until a pushed record is pushed. It is the default behavior.</p>
<p>If you passes <code>:block? =&gt; false</code> option, the pull operation returns
immediately, the given block isn&#8217;t called and returns nil when no
record exist in the array.</p>
<p>Note that your signal handlers can&#8217;t be ran while a pull
operation. You need to use <span class='object_link'><a href="#unblock-instance_method" title="Groonga::Array#unblock (method)">#unblock</a></span> from
another process to unblock the pull operation. If you call
<span class='object_link'><a href="#unblock-instance_method" title="Groonga::Array#unblock (method)">#unblock</a></span>, signal handler can be ran.</p>

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>A program that pulls with non-block mode</p></div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_queue'>queue</span> <span class='op'>=</span> <span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CrawlURLQueue</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_loop'>loop</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='comment'># The case for no pushed records in the array.
</span>  <span class='id identifier rubyid_pulled_record'>pulled_record</span> <span class='op'>=</span> <span class='id identifier rubyid_queue'>queue</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span><span class='lparen'>(</span><span class='symbol'>:block?</span> <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_record'>record</span><span class='op'>|</span>
    <span class='comment'># This block isn't called
</span>    <span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_pulled_record'>pulled_record</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='comment'># =&gt; true
</span><span class='kw'>end</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Signal handler isn&#8217;t called</p></div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_queue'>queue</span> <span class='op'>=</span> <span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CrawlURLQueue</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_trap'>trap</span><span class='lparen'>(</span><span class='symbol'>:INT</span><span class='rparen'>)</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_p'>p</span> <span class='symbol'>:not_called!</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_queue'>queue</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_record'>record</span><span class='op'>|</span>
  <span class='comment'># Send SIGINT while blocking the pull operation.
</span>  <span class='comment'># The signal handler isn't called.
</span><span class='kw'>end</span></code></pre>
    
  </div>

  <div class="docstring">
  <div class="discussion">
    <p>Returns A pulled record that is yielded.</p>

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>::Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The option parameters.</p></div>
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:block?</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>Whether the pull operation is blocked or not when no record exist
in the array.</p></div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>record</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Gets required values for a pull record in the given block.</p></div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>record</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Record.html" title="Groonga::Record (class)">Groonga::Record</a></span> or nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A pulled record. It is nil when no records exist in the array
and <code>block?</code> parameter is not <code>true</code>.</p></div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Record.html" title="Groonga::Record (class)">Groonga::Record</a></span> or nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A pulled record that is yielded.</p></div>
      
    </li>
  
</ul>

</div>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#push-instance_method" title="Groonga::Array#push (method)">Examples exist in the push documentation.</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/groonga/rb-grn-array.c', line 385</span>

static VALUE
rb_grn_array_pull (int argc, VALUE *argv, VALUE self)
{
    grn_ctx *context = NULL;
    grn_obj *table;
    VALUE options;
    VALUE rb_block_p;
    YieldRecordCallbackData data;

    rb_scan_args(argc, argv, &quot;01&quot;, &amp;options);

    rb_grn_scan_options(options,
                        &quot;block?&quot;, &amp;rb_block_p,
                        NULL);

    if (!rb_block_given_p()) {
        rb_raise(rb_eArgError,
                 &quot;tried to call Groonga::Array#pull without a block&quot;);
    }

    table = SELF(self, &amp;context);

    if (NIL_P(rb_block_p)) {
        rb_block_p = Qtrue;
    }

    data.self = self;
    data.record = Qnil;
    data.status = 0;
    grn_array_pull(context, (grn_array *)table, RVAL2CBOOL(rb_block_p),
                   yield_record_callback, &amp;data);
    if (data.status != 0) {
        rb_jump_tag(data.status);
    }
    rb_grn_context_check(context, self);

    return data.record;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="push-instance_method">
  
    - (<tt><span class='object_link'><a href="Record.html" title="Groonga::Record (class)">Groonga::Record</a></span> or nil</tt>) <strong>push</strong> {|record| ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Pushes a record to the array. The record should be filled in the
given block. The pushed record can be pulled by
<span class='object_link'><a href="#pull-instance_method" title="Groonga::Array#pull (method)">#pull</a></span>.</p>
<p>The record that is passed to the given block may be nil. You need
to handle the case. For example, just ignoring it or reports an
error.</p>
<p>If an error is occurred in the given block, the pushed record may
not be filled completely. You should handle the case in pull side.</p>

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>A program that pushes a job without error handling</p></div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_queue'>queue</span> <span class='op'>=</span> <span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CrawlURLQueue</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_queue'>queue</span><span class='period'>.</span><span class='id identifier rubyid_define_column'>define_column</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>url</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ShortText</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_urls'>urls</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://groonga.org/</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://ranguba.org/</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
<span class='id identifier rubyid_urls'>urls</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_url'>url</span><span class='op'>|</span>
  <span class='id identifier rubyid_queue'>queue</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_record'>record</span><span class='op'>|</span>
    <span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='id identifier rubyid_url'>url</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>A program that pulls a job without error handling</p></div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_queue'>queue</span> <span class='op'>=</span> <span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CrawlURLQueue</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_loop'>loop</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_queue'>queue</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_record'>record</span><span class='op'>|</span>
    <span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span>
  <span class='kw'>end</span>
  <span class='comment'># Crawl URL
</span><span class='kw'>end</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>A program that pushes a job with error handling</p></div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_queue'>queue</span> <span class='op'>=</span> <span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CrawlURLQueue</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_queue'>queue</span><span class='period'>.</span><span class='id identifier rubyid_define_column'>define_column</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>url</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ShortText</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_urls'>urls</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://groonga.org/</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://ranguba.org/</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
<span class='id identifier rubyid_urls'>urls</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_url'>url</span><span class='op'>|</span>
  <span class='id identifier rubyid_queue'>queue</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_record'>record</span><span class='op'>|</span>
    <span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='id identifier rubyid_url'>url</span> <span class='kw'>if</span> <span class='id identifier rubyid_record'>record</span> <span class='comment'># check record is not nil
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>A program that has an error in push block</p></div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_queue'>queue</span> <span class='op'>=</span> <span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CrawlURLQueue</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_queue'>queue</span><span class='period'>.</span><span class='id identifier rubyid_define_column'>define_column</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>url</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ShortText</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_urls'>urls</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://groonga.org/</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://ranguba.org/</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
<span class='id identifier rubyid_urls'>urls</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_url'>url</span><span class='op'>|</span>
  <span class='id identifier rubyid_queue'>queue</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_record'>record</span><span class='op'>|</span>
    <span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='id identifier rubyid_uri'>uri</span> <span class='comment'># Typo! It should be ur*l* not ur*i*
</span>    <span class='comment'># record.url isn't set
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>A program that pulls a job with error handling</p></div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_queue'>queue</span> <span class='op'>=</span> <span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CrawlURLQueue</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_loop'>loop</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_queue'>queue</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_record'>record</span><span class='op'>|</span>
    <span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span> <span class='comment'># record.url is nil!
</span>    <span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span>
  <span class='kw'>end</span>
  <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_url'>url</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='comment'># Ignore an uncompleted added job
</span>  <span class='comment'># Crawl URL
</span><span class='kw'>end</span></code></pre>
    
  </div>

  <div class="docstring">
  <div class="discussion">
    <p>Returns A pushed record that is yielded.</p>

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>record</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Filles columns of a pushed record in the given block.</p></div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>record</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Record.html" title="Groonga::Record (class)">Groonga::Record</a></span> or nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A pushed record. It is nil when pushing is failed.</p></div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Record.html" title="Groonga::Record (class)">Groonga::Record</a></span> or nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A pushed record that is yielded.</p></div>
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/groonga/rb-grn-array.c', line 302</span>

static VALUE
rb_grn_array_push (VALUE self)
{
    grn_ctx *context = NULL;
    grn_obj *table;
    YieldRecordCallbackData data;

    if (!rb_block_given_p()) {
        rb_raise(rb_eArgError,
                 &quot;tried to call Groonga::Array#push without a block&quot;);
    }

    table = SELF(self, &amp;context);

    data.self = self;
    data.record = Qnil;
    data.status = 0;
    grn_array_push(context, (grn_array *)table, yield_record_callback, &amp;data);
    if (data.status != 0) {
        rb_jump_tag(data.status);
    }
    rb_grn_context_check(context, self);

    return data.record;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unblock-instance_method">
  
    - (<tt>void</tt>) <strong>unblock</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Unblocks all <span class='object_link'><a href="#pull-instance_method" title="Groonga::Array#pull (method)">#pull</a></span> operations for the array.</p>

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Pull, unblock and signal</p></div></p>
      
      <pre class="example code"><code><span class='comment'># pull.rb
</span><span class='id identifier rubyid_queue'>queue</span> <span class='op'>=</span> <span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CrawlURLQueue</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_trap'>trap</span><span class='lparen'>(</span><span class='symbol'>:INT</span><span class='rparen'>)</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_p'>p</span> <span class='symbol'>:called!</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_queue'>queue</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_record'>record</span><span class='op'>|</span>
  <span class='comment'># 1. Send SIGINT while blocking the pull operation.
</span>  <span class='comment'>#    The signal handler isn't called.
</span>  <span class='comment'># 2. Run unblock.rb.
</span>  <span class='comment'>#    The signal handler is called!
</span><span class='kw'>end</span>

<span class='comment'># unblock.rb
</span><span class='id identifier rubyid_queue'>queue</span> <span class='op'>=</span> <span class='const'>Groonga</span><span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CrawlURLQueue</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_queue'>queue</span><span class='period'>.</span><span class='id identifier rubyid_unblock'>unblock</span></code></pre>
    
  </div>

  <div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>

  </div>
</div>
<div class="tags">
  

</div>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#pull-instance_method" title="Groonga::Array#pull (method)">#pull</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


450
451
452
453
454
455
456
457
458
459
460
461</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/groonga/rb-grn-array.c', line 450</span>

static VALUE
rb_grn_array_unblock (VALUE self)
{
    grn_ctx *context = NULL;
    grn_obj *table;

    table = SELF(self, &amp;context);

    grn_array_unblock(context, (grn_array *)table);

    return Qnil;
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer"></div>

  
    </div>

    <div class="sponsors">
      <p id="sponsor-github">
        <a href="https://github.com/ranguba/">
          <img src="../../../github-logo.png" width="100" height="45" border="0" alt="The Ranguba project uses GitHub's git repositories." />
        </a>
      </p>
      <p id="sponsor-tango">
	<a href="http://tango.freedesktop.org/">
          <img width="120" height="53" border="0" alt="Tango Desktop Project's icons are used." src="../../../tango-logo.png" />
        </a>
      </p>
      <p id="sponsor-famfamfam">
	<a href="http://www.famfamfam.com/">
          <img width="120" height="18" border="0" alt="famfamfam.com's flags are used." src="../../../famfamfam-logo.png" />
        </a>
      </p>
    </div>

</body>
</html>