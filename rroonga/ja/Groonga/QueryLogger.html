<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../ranguba.css" type="text/css" />
    <link rel="shortcut icon" href="../../../favicon.ico" />
    <link rel="icon" href="../../../favicon.png" />
    <title>
  Class: Groonga::QueryLogger
  
    &mdash; rroonga
  
 - ラングバ</title>


  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!Groonga/QueryLogger.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
<div class="header">
  <div class="title">
    <a href="../../../ja/">
      <span class="title">
  Class: Groonga::QueryLogger
  
    &mdash; rroonga
  
</span>
      <span class="title-separator">-</span>
      <span class="title-project">ラングバ</span>
    </a>
  </div>
  <ul class="other-languages">
    <li id="other-language-english" lang="en" xml:lang="en"><a href="../../../rroonga/en/Groonga/QueryLogger.html">English</a></li>
  </ul>
  <ul class="menu">
    <li id="menu-reference"><a href="../../../rroonga/ja/">リファレンスマニュアル</a></li>
    <li id="menu-tutorial"><a href="../../../rroonga/ja/file.tutorial.html">チュートリアル</a></li>
    <li id="menu-install"><a href="../../../ja/#install-rroonga">インストール</a></li>
    <li id="menu-developer"><a href="../../../ja/developer.html">開発者向け情報</a></li>
  </ul>
</div>

<div class="content">


    <div id="header">
      <div id="menu">
  
    <a href="../alphabetical_index.html">Index (Q)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Groonga.html" title="Groonga (module)">Groonga</a></span></span>
     &raquo; 
    <span class="title">QueryLogger</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Groonga::QueryLogger
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Groonga::QueryLogger</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">ext/groonga/rb-grn-query-logger.c<span class="defines">,<br />
  lib/groonga/query-logger.rb,<br /> ext/groonga/rb-grn-query-logger.c</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>A class for logging query log.</p>


  </div>
</div>
<div class="tags">
  

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="CallbackQueryLogger.html" title="Groonga::CallbackQueryLogger (class)">CallbackQueryLogger</a></span>, <span class='object_link'><a href="FileQueryLogger.html" title="Groonga::FileQueryLogger (class)">FileQueryLogger</a></span></p>
</div>
<h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="QueryLogger/Flags.html" title="Groonga::QueryLogger::Flags (module)">Flags</a></span>
    
  
    
  
</p>







  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#log-class_method" title="log (class method)">+ (void) <strong>log</strong>(message, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Logs a message.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#path-class_method" title="path (class method)">+ (String or nil) <strong>path</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Gets the current query log path that is used the default query logger.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#path%3D-class_method" title="path= (class method)">+ (Object) <strong>path=</strong>(path) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Sets the query log path that is used the default query logger.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#register-class_method" title="register (class method)">+ (Object) <strong>register</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Registers a query logger or a callback that is called when a query log event is emitted.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reopen-class_method" title="reopen (class method)">+ (Object) <strong>reopen</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Sends reopen request to the current query logger.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rotate_threshold_size-class_method" title="threshold (class method)">+ (Integer) <strong>threshold</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Gets the current rotate threshold size that is used by the default query logger.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rotate_threshold_size%3D-class_method" title="rotate_threshold_size= (class method)">+ (Object) <strong>rotate_threshold_size=</strong>(size) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Sets the rotate threshold size that is used by the default query logger.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unregister-class_method" title="unregister (class method)">+ (Object) <strong>unregister</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fin-instance_method" title="#fin (instance method)">- (Object) <strong>fin</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#log-instance_method" title="#log (instance method)">- (Object) <strong>log</strong>(flag, timestamp, info, message) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reopen-instance_method" title="#reopen (instance method)">- (Object) <strong>reopen</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="log-class_method">
  
    + (<tt>void</tt>) <strong>log</strong>(message, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Logs a message.</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>message</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The log message.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>::Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:context</span>
          <span class="type">(<tt><span class='object_link'><a href="Context.html" title="Groonga::Context (class)">Groonga::Context</a></span></tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>Groonga::Context.default</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>The context for the message.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:flags</span>
          <span class="type">(<tt>nil</tt>, <tt>Integer</tt>, <tt>String</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>0</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>The flags for the message.</p>

<p>The flags are passed to query logger. You can custom query
logger behavior by the flags. For example, you can omit elapsed
time by passing <code>Groonga::QueryLogger::COMMAND</code> flag or
<code>Groonga::QueryLogger::DESTINATION</code>.</p>

<p>If <code>:flags</code> value is <code>String</code>, parsed by
parse.</p>

<p><code>nil</code> equals to <code>0</code>.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:mark</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>&quot;:&quot;
The mark for the message.

Normally</tt>, <tt>a character is used as a mark such as `&quot;:&quot;`</tt>, <tt>`&quot;&lt;&quot;` and `&quot;&gt;&quot;`.</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>””)
The mark for the message.</p>

<p>Normally, a character is used as a mark such as <code>":"</code>, <code>"&lt;"</code> and <code>"&gt;"</code>.</p>
</div>
          
        </li>
      
    </ul>
  


</div>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>5.0.2</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/groonga/rb-grn-query-logger.c', line 76</span>

static VALUE
rb_grn_query_logger_s_log (int argc, VALUE *argv, VALUE klass)
{
    VALUE rb_message;
    const char *message;
    VALUE rb_context = Qnil;
    grn_ctx *context;
    VALUE rb_flags;
    unsigned int flags = GRN_QUERY_LOG_NONE;
    VALUE rb_mark;
    const char *mark = &quot;&quot;;
    VALUE rb_options;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;rb_message, &amp;rb_options);

    message = StringValueCStr(rb_message);

    rb_grn_scan_options(rb_options,
                        &quot;context&quot;, &amp;rb_context,
                        &quot;flags&quot;,   &amp;rb_flags,
                        &quot;mark&quot;,    &amp;rb_mark,
                        NULL);

    context = rb_grn_context_ensure(&amp;rb_context);

    if (!NIL_P(rb_flags)) {
        flags = rb_funcall(mGrnQueryLoggerFlags, id_parse, 2,
                           rb_flags, UINT2NUM(flags));
    }
    if (!NIL_P(rb_mark)) {
        mark = StringValueCStr(rb_mark);
    }

    grn_query_logger_put(context, flags, mark, &quot;%s&quot;, message);

    return Qnil;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="path-class_method">
  
    + (<tt>String or nil</tt>) <strong>path</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Gets the current query log path that is used the default query logger.</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    <p>Returns The current query log path</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String or nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The current query log path</p>
</div>
      
    </li>
  
</ul>

</div>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>3.0.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


295
296
297
298
299
300
301
302
303
304
305
306</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/groonga/rb-grn-query-logger.c', line 295</span>

static VALUE
rb_grn_query_logger_s_get_path (VALUE klass)
{
    const char *path;
    VALUE rb_path = Qnil;

    path = grn_default_query_logger_get_path();
    if (path) {
        rb_path = rb_str_new_cstr(path);
    }
    return rb_path;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="path=-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>) <strong>path=</strong>(path) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Sets the query log path that is used the default query logger. If
you’re using custom query logger by <span class='object_link'><a href="#register-class_method" title="Groonga::QueryLogger.register (method)">register</a></span>, the query log path
isn’t used. Because it is for the default query logger.</p>

<p>If you specify nil as path, query logging by the default query
logger is disabled.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Changes the query log path for the default query logger</p>
</div></p>
      
      <pre class="example code"><code><span class='const'>Groonga</span><span class='op'>::</span><span class='const'>QueryLogger</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/query.log</span><span class='tstring_end'>&quot;</span></span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Disables query log by the default query logger</p>
</div></p>
      
      <pre class="example code"><code><span class='const'>Groonga</span><span class='op'>::</span><span class='const'>QueryLogger</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='kw'>nil</span></code></pre>
    
  </div>

  <div class="docstring">
  <div class="discussion">
    <p>Returns void</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String or nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The query log path for the default query
logger. If nil is specified, query logging by the default query logger
is disabled.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>void</p>
</div>
      
    </li>
  
</ul>

</div>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>3.0.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/groonga/rb-grn-query-logger.c', line 330</span>

static VALUE
rb_grn_query_logger_s_set_path (VALUE klass, VALUE rb_path)
{
    grn_bool need_reopen = GRN_FALSE;
    const char *old_path = NULL;
    const char *path = NULL;

    rb_path = rb_grn_check_convert_to_string(rb_path);
    if (!NIL_P(rb_path)) {
        path = StringValuePtr(rb_path);
    }

    old_path = grn_default_query_logger_get_path();
    if (!rb_grn_equal_string(old_path, path)) {
        need_reopen = GRN_TRUE;
    }

    grn_default_query_logger_set_path(path);

    if (need_reopen) {
        rb_grn_query_logger_s_reopen(klass);
    }

    return Qnil;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="register-class_method">
  
    
      <span class="overload">+ (<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>) <strong>register</strong>(logger, options = {}) </span>
    
      <span class="overload">+ (<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>) <strong>register</strong>(options = {}) {|action, flag, timestamp, info, message| ... }</span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Registers a query logger or a callback that is called when a
query log event is emitted.</p>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">+ (<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>) <strong>register</strong>(logger, options = {}) </span>
        <div class="docstring">
  <div class="discussion">
    <p>Returns void</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>logger</span>
      
      
        <span class='type'>(<tt>#<span class='object_link'><a href="#log-class_method" title="Groonga::QueryLogger.log (method)">log</a></span></tt>, <tt>#<span class='object_link'><a href="#reopen-class_method" title="Groonga::QueryLogger.reopen (method)">reopen</a></span></tt>, <tt>#fin</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The query logger. It is easy to
inherit <span class='object_link'><a href="" title="Groonga::QueryLogger (class)">Groonga::QueryLogger</a></span>.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>void</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">+ (<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>) <strong>register</strong>(options = {}) {|action, flag, timestamp, info, message| ... }</span>
        <div class="docstring">
  <div class="discussion">
    


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>::Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The options.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:flags</span>
          <span class="type">(<tt>Symbol</tt>, <tt>String</tt>, <tt>Integer or nil</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>:default</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>Flags describe what query log should be logged.</p>

<p>If <code>flags</code> is String, it is parsed by <span class='object_link'><a href="QueryLogger/Flags.html#parse-class_method" title="Groonga::QueryLogger::Flags.parse (method)">Groonga::QueryLogger::Flags.parse</a></span>.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>action</tt>, <tt>flag</tt>, <tt>timestamp</tt>, <tt>info</tt>, <tt>message</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>…</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/groonga/rb-grn-query-logger.c', line 179</span>

static VALUE
rb_grn_query_logger_s_register (int argc, VALUE *argv, VALUE klass)
{
    VALUE rb_context = Qnil;
    grn_ctx *context;
    VALUE rb_logger, rb_callback;
    VALUE rb_options, rb_command, rb_result_code, rb_destination;
    VALUE rb_cache, rb_size, rb_score, rb_default, rb_all, rb_flags;
    unsigned int flags = GRN_QUERY_LOG_NONE;

    rb_scan_args(argc, argv, &quot;02&amp;&quot;, &amp;rb_logger, &amp;rb_options, &amp;rb_callback);

    if (rb_block_given_p()) {
        rb_logger = rb_funcall(cGrnCallbackQueryLogger, id_new, 1, rb_callback);
    }

    rb_grn_scan_options(rb_options,
                        &quot;command&quot;,     &amp;rb_command,
                        &quot;result_code&quot;, &amp;rb_result_code,
                        &quot;destination&quot;, &amp;rb_destination,
                        &quot;cache&quot;,       &amp;rb_cache,
                        &quot;size&quot;,        &amp;rb_size,
                        &quot;score&quot;,       &amp;rb_score,
                        &quot;default&quot;,     &amp;rb_default,
                        &quot;all&quot;,         &amp;rb_all,
                        &quot;flags&quot;,       &amp;rb_flags,
                        NULL);

    if (RVAL2CBOOL(rb_command)) {
        flags |= GRN_QUERY_LOG_COMMAND;
    }
    if (RVAL2CBOOL(rb_result_code)) {
        flags |= GRN_QUERY_LOG_RESULT_CODE;
    }
    if (RVAL2CBOOL(rb_destination)) {
        flags |= GRN_QUERY_LOG_DESTINATION;
    }
    if (RVAL2CBOOL(rb_cache)) {
        flags |= GRN_QUERY_LOG_CACHE;
    }
    if (RVAL2CBOOL(rb_size)) {
        flags |= GRN_QUERY_LOG_SIZE;
    }
    if (RVAL2CBOOL(rb_score)) {
        flags |= GRN_QUERY_LOG_SCORE;
    }
    if (RVAL2CBOOL(rb_default)) {
        flags |= GRN_QUERY_LOG_DEFAULT;
    }
    if (RVAL2CBOOL(rb_all)) {
        flags |= GRN_QUERY_LOG_ALL;
    }
    if (!NIL_P(rb_flags)) {
        flags = rb_funcall(mGrnQueryLoggerFlags, id_parse, 2,
                           rb_flags, UINT2NUM(flags));
    }

    rb_grn_query_logger.flags     = flags;
    rb_grn_query_logger.user_data = (void *)rb_logger;

    context = rb_grn_context_ensure(&amp;rb_context);
    grn_query_logger_set(context, &amp;rb_grn_query_logger);
    rb_grn_context_check(context, rb_logger);
    rb_cv_set(klass, &quot;@@current_logger&quot;, rb_logger);

    return Qnil;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reopen-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>) <strong>reopen</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Sends reopen request to the current query logger. It is useful for
rotating log file.</p>


  </div>
</div>
<div class="tags">
  
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>void</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


274
275
276
277
278
279
280
281
282
283
284
285</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/groonga/rb-grn-query-logger.c', line 274</span>

static VALUE
rb_grn_query_logger_s_reopen (VALUE klass)
{
    VALUE rb_context = Qnil;
    grn_ctx *context;

    context = rb_grn_context_ensure(&amp;rb_context);
    grn_query_logger_reopen(context);
    rb_grn_context_check(context, klass);

    return Qnil;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rotate_threshold_size-class_method">
  
    + (<tt>Integer</tt>) <strong>threshold</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Gets the current rotate threshold size that is used by the default
query logger.</p>

<p>If the size is larger than 0, log rotate feature is enabled in the
default query logger.</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    <p>Returns The current rotate threshold size</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The current rotate threshold size</p>
</div>
      
    </li>
  
</ul>

</div>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>5.0.2</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


368
369
370
371
372</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/groonga/rb-grn-query-logger.c', line 368</span>

static VALUE
rb_grn_query_logger_s_get_rotate_threshold_size (VALUE klass)
{
    return OFFT2NUM(grn_default_query_logger_get_rotate_threshold_size());
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rotate_threshold_size=-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>) <strong>rotate_threshold_size=</strong>(size) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Sets the rotate threshold size that is used by the default query
logger. If you’re using custom query logger by <span class='object_link'><a href="#register-class_method" title="Groonga::QueryLogger.register (method)">register</a></span>, the
rotate threshold size isn’t used. Because it is for the default
query logger.</p>

<p>If you specify <code>0</code> as size, log rotation by the default query
logger is disabled.</p>

<p>The default rotate threshold size is 0. It means that log rotation
is disabled by default.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Changes the rotate threshold size for the default query logger</p>
</div></p>
      
      <pre class="example code"><code><span class='const'>Groonga</span><span class='op'>::</span><span class='const'>QueryLogger</span><span class='period'>.</span><span class='id identifier rubyid_rotate_threshold_size'>rotate_threshold_size</span> <span class='op'>=</span> <span class='int'>1</span> <span class='op'>*</span> <span class='int'>1024</span> <span class='op'>*</span> <span class='int'>1024</span> <span class='comment'># 1MiB</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Disables log ration by the default query logger</p>
</div></p>
      
      <pre class="example code"><code><span class='const'>Groonga</span><span class='op'>::</span><span class='const'>QueryLogger</span><span class='period'>.</span><span class='id identifier rubyid_rotate_threshold_size'>rotate_threshold_size</span> <span class='op'>=</span> <span class='int'>0</span></code></pre>
    
  </div>

  <div class="docstring">
  <div class="discussion">
    <p>Returns void</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>size</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The log path for the default query logger.
If nil is specified, log rotate by the default query logger is
disabled.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>void</p>
</div>
      
    </li>
  
</ul>

</div>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>5.0.2</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


400
401
402
403
404
405
406</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/groonga/rb-grn-query-logger.c', line 400</span>

static VALUE
rb_grn_query_logger_s_set_rotate_threshold_size (VALUE klass, VALUE rb_size)
{
    grn_default_query_logger_set_rotate_threshold_size(NUM2OFFT(rb_size));

    return Qnil;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unregister-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>) <strong>unregister</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/groonga/rb-grn-query-logger.c', line 247</span>

static VALUE
rb_grn_query_logger_s_unregister (VALUE klass)
{
    VALUE current_logger;
    VALUE rb_context = Qnil;
    grn_ctx *context;

    current_logger = rb_cv_get(klass, &quot;@@current_logger&quot;);
    if (NIL_P(current_logger))
        return Qnil;

    rb_cv_set(klass, &quot;@@current_logger&quot;, Qnil);

    context = rb_grn_context_ensure(&amp;rb_context);
    grn_query_logger_set(context, NULL);
    rb_grn_context_check(context, klass);

    return Qnil;
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="fin-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>) <strong>fin</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


101
102</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/groonga/query-logger.rb', line 101</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fin'>fin</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="log-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>) <strong>log</strong>(flag, timestamp, info, message) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94
95
96</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/groonga/query-logger.rb', line 92</span>

<span class='kw'>def</span> <span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='id identifier rubyid_flag'>flag</span><span class='comma'>,</span> <span class='id identifier rubyid_timestamp'>timestamp</span><span class='comma'>,</span> <span class='id identifier rubyid_info'>info</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_guard'>guard</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_puts'>puts</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_timestamp'>timestamp</span><span class='embexpr_end'>}</span><span class='tstring_content'>|</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reopen-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Groonga::Object (class)">Object</a></span></tt>) <strong>reopen</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


98
99</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/groonga/query-logger.rb', line 98</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reopen'>reopen</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Mon Mar  7 00:39:35 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.3.0).
</div>

  
    </div>

    <div class="sponsors">
      <p id="sponsor-github">
        <a href="http://github.com/ranguba/">
          <img src="../../../github-logo.png" width="100" height="45" border="0" alt="ラングバプロジェクトはGitHubにホスティングしてもらっています。" />
        </a>
      </p>
      <p id="sponsor-tango">
	<a href="http://tango.freedesktop.org/">
          <img width="120" height="53" border="0" alt="Tango Desktop Projectのアイコンを利用しています。" src="../../../tango-logo.png" />
        </a>
      </p>
    </div>

</body>
</html>